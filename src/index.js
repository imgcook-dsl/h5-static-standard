module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){const{toString:r,existImport:o,parseLoop:s,parseStyle:a,deepClone:i,parseFunction:p,parseProps:c,parseState:l,parseLifeCycles:u,replaceState:d,parseCondition:f,generateCSS:m,parseDataSource:h,line2Hump:$,getText:y,isExpression:g}=n(1);e.exports=function(e,t){const{prettier:n,scale:s=1,componentsMap:i,_:d,responsive:f}=t,m=e.fileName;let y=[],b=[];const x=[],S=[],j=[],v=[];let O=null,k=[];const w=[];let C=[];const N=[],A=(f.width,f.viewportWidth,e=>{const t=e.componentName,n=e.componentName.toLowerCase(),r=e.props&&e.props.className,s=r?` className="${r}"`:"";let p,l={},u={};Object.keys(e.props.style||{}).forEach(t=>{g(e.props.style[t])?u[t]=e.props.style[t]:l[t]=e.props.style[t]}),e.props.codeStyle=u,r&&(x.push(`\n        .${r} {\n          ${a(l,{_:d,responsive:f})}\n        }\n      `),S.push(`\n        .${r} {\n          ${a(l,{toVW:!0,_:d,responsive:f})}\n        }\n      `),j.push(`\n        .${r} {\n          ${a(l,{toREM:!0,_:d,responsive:f})}\n        }\n      `));let m="";switch(Object.keys(e.props).forEach(t=>{-1===["className","style","text","src","key","codeStyle","onClick"].indexOf(t)&&(m+=` ${t}={${c(e.props[t])}}`),"codeStyle"===t&&"{}"!==JSON.stringify(e.props[t])&&(m+=` style={${c(e.props[t])}}`)}),n){case"text":let n=c(e.props.text||e.text,!0);n.match(/this\.props/)&&(n=n.replace(/this\./,"")),p=`<span ${s}${m}>${n||""}</span>`;break;case"image":p=(e.props.source&&e.props.source.uri,`<img ${s}${m} />`);break;case"div":case"view":case"page":case"block":case"component":p=e.children&&e.children.length?`<div${s}${m}>${E(e.children)}</div>`:`<div${s}${m} />`;break;default:(e=>{let t=i[e]||{},n=t.package||t.packageName||e;n&&["view","image","text","picture"].indexOf(n.toLowerCase())>=0&&(n=`rax-${n.toLowerCase()}`);const r=`import ${e} from '${n}'`;o(y,r)||y.push({import:r,package:n,version:t.dependenceVersion||"*"})})(e.componentName),p=e.children&&e.children.length&&Array.isArray(e.children)?`<${t}${s}${m}>${E(e.children)}</${t}>`:"string"==typeof e.children?`<${t}${s}${m} >${e.children}</${t}>`:`<${t}${s}${m} />`}return p}),E=e=>{let t="";const n=e.fileName||e.id;if(Array.isArray(e))e.forEach(e=>{t+=E(e)});else{const o=e.componentName.toLowerCase();if(-1!==["page"].indexOf(o)||n===m){const t=[];if(e.state&&(t.push(`state = ${r(e.state)}`),O=r(e.state)),e.methods&&Object.keys(e.methods).forEach(t=>{const{params:n,content:r}=p(e.methods[t]);w.push(`function ${t}(${n}) {${r}}`)}),e.dataSource&&Array.isArray(e.dataSource.list)&&(e.dataSource.list.forEach(e=>{"boolean"==typeof e.isInit&&e.isInit?N.push(`${e.id}();`):"string"==typeof e.isInit&&N.push(`if (${c(e.isInit)}) { ${e.id}(); }`);const t=h(e,y);w.push(t.value),y=t.imports}),e.dataSource.dataHandler)){const{params:t,content:n}=p(e.dataSource.dataHandler);w.push(`const dataHandler = (${t}) => {${n}}`),N.push("dataHandler()")}e.lifeCycles&&(C=u(e,N)),O&&k.push(l(O))}else if(-1!==["block"].indexOf(o)){let r="";Object.keys(e.props).forEach(t=>{-1===["className","style","text","src","key"].indexOf(t)&&(r+=` ${t}={${c(e.props[t])}}`)}),t+=`<${$(n)} ${r} />`,b.push({import:`import ${$(n)} from '../${n}';`})}else t+=A(e)}return t};t.utils&&Object.keys(t.utils).forEach(e=>{v.push(`const ${e} = ${t.utils[e]}`)}),E(e);const _={parser:"css"},T=A(e);console.log(T);const L=n.format(`\n  <!DOCTYPE html>\n  <html lang="en">\n  <head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Document</title>\n  </head>\n  <body>\n  ${T}\n  </body>\n  </html>\n  `,{parser:"html",printWidth:120,singleQuote:!0});return{panelDisplay:[{panelName:`${m}.html`,panelValue:L,panelType:"html",panelImports:y},{panelName:`${m}.css`,panelValue:n.format(x.join("\n"),_),panelType:"css"},{panelName:`${m}.vw.css`,panelValue:n.format(S.join("\n"),_),panelType:"css"},{panelName:`${m}.rem.css`,panelValue:n.format(j.join("\n"),_),panelType:"css"}],noTemplate:!0}}},function(e,t){const n=["opacity","fontWeight"],r=["fontSize","marginTop","marginBottom","paddingTop","paddingBottom","height","top","bottom","width","maxWidth","left","right","paddingRight","paddingLeft","marginLeft","marginRight","lineHeight","borderBottomRightRadius","borderBottomLeftRadius","borderTopRightRadius","borderTopLeftRadius","borderRadius"],o=e=>/^\{\{.*\}\}$/.test(e),s=(e,t)=>e=t?e.slice(1,-1).replace(/this\./gim,""):e.slice(2,-2).replace(/this\./gim,""),a=e=>"[object Function]"==={}.toString.call(e)?e.toString():"string"==typeof e?e:"object"==typeof e?JSON.stringify(e,(e,t)=>"function"==typeof t?t.toString():t):String(e),i=e=>e.charAt(0).toUpperCase()+e.slice(1),p=e=>{let t=Array.isArray(e)?[]:{};if(e&&"object"==typeof e)for(const n in e)e.hasOwnProperty(n)&&(e[n]&&"object"==typeof e[n]?t[n]=p(e[n]):t[n]=e[n]);return t},c=e=>{const t=e.toString();return{params:t.match(/\([^\(\)]*\)/)[0].slice(1,-1),content:t.slice(t.indexOf("{")+1,t.lastIndexOf("}"))}},l=(e,t)=>{if("string"==typeof e)return o(e)?s(e,t):t?e:`'${e}'`;if("function"==typeof e){const{params:t,content:n}=c(e);return`(${t}) => {${n}}`}return"boolean"==typeof e||"number"==typeof e?String(e):"object"==typeof e?Array.isArray(e)?`[${e.map(e=>l(e)).join(", ")}]`:`{${Object.keys(e).map(t=>`${/^\w+$/.test(t)?t:`'${t}'`}: ${l(e[t])}`).join(", ")}}`:void 0},u=(e,t)=>"boolean"==typeof e?e?`${t}`:"":"string"==typeof e&&o(e)?(e=s(e))?`(${e}) && ${t}`:`${t}`:t,d=e=>{const t=new RegExp("this.state","g");return e.replace(t,"state")},f=(e,t)=>{let n=!1;return e.forEach(e=>{e.import===t&&(n=!0)}),n};e.exports={isExpression:o,toString:a,transComponentsMap:(e={})=>{if(!e||!Array.isArray(e.list))return[];return e.list.reduce((e,t)=>{const n=t.name;if(!e[n]){try{let e=JSON.parse(t.dependence);e&&(t.packageName=e.package),t.dependenceVersion||(t.dependenceVersion="*"),/^\d/.test(t.dependenceVersion)&&(t.dependenceVersion="^"+t.dependenceVersion)}catch(e){}e[n]=t}return e},{})},line2Hump:e=>e=(e=e.replace(/[_|-](\w)/g,(e,t)=>t.toUpperCase())).charAt(0).toUpperCase()+e.slice(1),existImport:f,toUpperCaseStart:i,parseStyle:(e,t={})=>{const{toVW:o,toREM:s,_:a,responsive:i}=t,p=i.width||750,c=i.viewportWidth||375,l=c?c/10:null,u=p/100,d=[];for(let t in e){let i=e[t];if(-1!=r.indexOf(t)){if(o)i=(parseInt(i)/u).toFixed(2),i=0==i?i:i+"vw";else if(s&&l){const e=(("string"==typeof i?i.replace(/(px)|(rem)/,""):i)*(c/p)).toFixed(2);i=parseFloat((e/l).toFixed(2)),i=i?`${i}rem`:i}else i=parseInt(i).toFixed(2),i=0==i?i:i+"px";d.push(`${a.kebabCase(t)}: ${i}`)}else-1!=n.indexOf(t)?d.push(`${a.kebabCase(t)}: ${parseFloat(i)}`):d.push(`${a.kebabCase(t)}: ${i}`)}return d.join(";")},deepClone:p,parseDataSource:(e,t)=>{const n=e.id,{uri:r,method:s,params:i}=e.options,p=e.type;let u,d={};switch(p){case"fetch":u="import {fetch} from 'whatwg-fetch';",f(t,u)||t.push({import:u,package:"whatwg-fetch",version:"^3.0.0"}),d={method:s};break;case"jsonp":u="import {fetchJsonp} from 'fetch-jsonp';",f(t,u)||t.push({import:u,package:"fetch-jsonp",version:"^1.1.3"})}Object.keys(e.options).forEach(t=>{-1===["uri","method","params"].indexOf(t)&&(d[t]=a(e.options[t]))});let m=null===(h=d)||"[object Object]"!==Object.prototype.toString.call(h)||Object.keys(h).length?",":"";var h;d=i?`${a(d).slice(0,-1)} ${m} body: ${o(i)?l(i):a(i)}}`:a(d);let $=`{\n  return ${p}(${l(r)}, ${a(d)})\n    .then((response) => response.json())\n`;if(e.dataHandler){const{params:t,content:n}=c(e.dataHandler);$+=`.then((${t}) => {${n}})\n    .catch((e) => {\n      console.log('error', e);\n    })\n  `}return $+="}",{value:`function ${n}() ${$}`,imports:t}},parseFunction:c,parseLoop:(e,t,n,r,i)=>{let p,c=t&&t[0]||"item",l=t&&t[1]||"index";Array.isArray(e)?p=a(e):o(e)&&(p=s(e)||"[]");const d=n.match(/^<.+?(\s|\b(?=>))/)[0].length;n=`${n.slice(0,d)} key={${l}}${n.slice(d)}`;const f=new RegExp(`this.${c}`,"g");n=n.replace(f,c);let m=p;return p.match(/this\.state\./)&&(m=`state.${p.split(".").pop()}`),i.condition&&(n=u(i.condition,n)),{hookState:[],value:`(${m} || []).map((${c}, ${l}) => {\n      return (${n});\n    })`}},parseCondition:u,parseProps:l,parseState:e=>`const [state, set${i("state")}] = useState(${a(JSON.parse(e))||null});`,parseLifeCycles:(e,t)=>{let n=[];return!e.lifeCycles._constructor&&t&&(e.lifeCycles._constructor="function _constructor() {}"),Object.keys(e.lifeCycles).forEach(r=>{let{params:o,content:s}=c(e.lifeCycles[r]);switch(s=d(s),r){case"_constructor":t.push(s),n.unshift(`\n          // constructor\n          useState(()=>{\n            ${t.join("\n")}\n          })\n        `);break;case"componentDidMount":n.push(`\n          // componentDidMount\n          useEffect(()=>{\n            ${s}\n          }, [])\n        `);break;case"componentDidUpdate":n.push(`\n          // componentDidUpdate\n          useEffect(()=>{\n            ${s}\n          })\n        `);break;case"componentWillUnMount":n.push(`\n          // componentWillUnMount\n          useEffect(()=>{\n            return ()=>{\n              ${s}\n            }\n          }, [])\n        `)}}),n},replaceState:d,generateCSS:e=>{let t="";for(let r in e){t+=`.${r} {`;for(let o in e[r])t+=`${n=o,n=n.split(/(?=[A-Z])/).join("-"),/^[A-Z].*/.test(n)&&(n="-"+n),n.toLowerCase()}: ${e[r][o]};\n`;t+="}"}var n;return t},getText:e=>{let t="";const n=e=>{"text"===e.componentName.toLowerCase()&&(t+=l(e.props.text||e.text,!0).replace(/\{/g,"${")),e.children&&Array.isArray(e.children)&&e.children.map(e=>{n(e)})};return n(e),t}}}]);